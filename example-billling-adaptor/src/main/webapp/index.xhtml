<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui = "http://java.sun.com/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Test billing adaptor panel</title>
        <style>
            .fHeader {
                text-align: left;
            }            
            .lHeader {
                text-align: left;
                font-weight: bold;
            }
            .lRow {
                text-align: left;
            }
            .tLine {
                float: left;
            }
            .content {
                max-width: 800px;
                margin: auto;
            }
            .bCommand {
                width: 140px;
                margin-left: 20px;
            }
        </style>
    </h:head>
    <h:body>
        <h:form id="indexView">
            <p:poll interval="3" update="indexView" listener="#{userSession.timerListener()}" />
            <div class="content">
                <h:dataTable id="clientList" border="0" width="360" styleClass="tLine"
                             value="#{userSession.clients}" var="client">
                    <h:column headerClass="fHeader">    				
                        <f:facet name="header">First name</f:facet>
                        <h:outputLabel value="#{client.firstName}"/>                    
                    </h:column>
                    <h:column headerClass="fHeader">
                        <f:facet name="header">Last name</f:facet>
                        <h:outputLabel value="#{client.lastName}"/>                    
                    </h:column>
                    <h:column headerClass="fHeader">
                        <f:facet name="header">Balance</f:facet>
                        <h:outputLabel value="#{client.account.balance}">
                            <f:convertNumber pattern="####0.00 cr"/>
                        </h:outputLabel>
                    </h:column>
                </h:dataTable>
                <h:panelGrid id="paymentStates" border="0" width="360" 
                             styleClass="tLine" headerClass="fHeader"
                             columns="3">
                    <h:outputLabel value="REGISTERED" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.registered}" styleClass="lRow" />
                    <h:commandButton value="START" styleClass="bCommand" 
                                     disabled="#{userSession.disableStartButton()}"
                                     action="#{userSession.start()}" >
                        <f:ajax render="@all" />
                    </h:commandButton>
                    <h:outputLabel value="PROCESSING" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.processing}" styleClass="lRow" />
                    <h:commandButton value="STOP" styleClass="bCommand"
                                     disabled="#{userSession.disableStopButton()}"
                                     action="#{userSession.stop()}" >
                        <f:ajax render="@all" />
                    </h:commandButton>
                    <h:outputLabel value="SUCCESS" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.success}" styleClass="lRow" />
                    <h:commandButton value="CLEAN" styleClass="bCommand" 
                                     disabled="#{userSession.disableStartButton()}"
                                     action="#{userSession.cleanData()}">
                        <f:ajax render="@all" />
                    </h:commandButton>
                    <h:outputLabel value="EXPIRED" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.expired}" styleClass="lRow" />
                    <h:commandButton value="GENERATE" styleClass="bCommand" 
                                     disabled="#{userSession.disableStartButton()}"
                                     action="#{userSession.generateData()}" >
                        <f:ajax render="@all" />
                    </h:commandButton>
                    <h:outputLabel value="CANCELED" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.canceled}" styleClass="lRow" />
                    <h:outputLabel value=" " styleClass="lRow" />
                    <h:outputLabel value="SYSTEM_ERROR" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.systemError}" styleClass="lRow" />
                    <h:outputLabel value=" " styleClass="lRow" />
                    <h:outputLabel value="TOTAL" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.stateCounter.all}" styleClass="lRow" />
                    <h:outputLabel value=" " styleClass="lRow" />
                    <h:outputLabel value="____________" styleClass="lRow" />
                    <h:outputLabel value=" " styleClass="lRow" />
                    <h:outputLabel value=" " styleClass="lRow" />
                    <h:outputLabel value="ETA" styleClass="lHeader" />
                    <h:outputLabel value="#{userSession.eta}" styleClass="lRow" />
                    <h:outputLabel value=" " styleClass="lRow" />
                </h:panelGrid>
            </div>
        </h:form>
    </h:body>
</html>

